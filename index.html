<!DOCTYPE html>
dropdowns.forEach(d => {
const summary = d.querySelector('summary');
if (!summary) return;


// Escritorio: abrir al pasar el mouse y evitar toggle por click
summary.addEventListener('mouseenter', () => {
if (!mqDesktop.matches) return;
closeAll();
d.setAttribute('open','');
});
summary.addEventListener('click', (e) => {
if (!mqDesktop.matches) return;
e.preventDefault();
});
d.addEventListener('mouseleave', () => {
if (!mqDesktop.matches) return;
d.removeAttribute('open');
});
});


navlinks.addEventListener('mouseleave', () => {
if (!mqDesktop.matches) return;
closeAll();
});


// Móvil: al abrir uno, cerrar los otros para evitar acumulación
navlinks.addEventListener('toggle', (e) => {
if (mqDesktop.matches) return;
const t = e.target;
if (t.tagName !== 'DETAILS' || !t.open) return;
dropdowns.forEach(d => { if (d !== t) d.removeAttribute('open'); });
}, true);
})();


// Bloquear scroll del fondo cuando el menú móvil está abierto
(function(){
const chk = document.getElementById('navchk');
if(!chk) return;
function toggleBody(){ document.body.classList.toggle('menu-open', chk.checked); }
chk.addEventListener('change', toggleBody);
// Cerrar con tecla Escape en móvil
window.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ chk.checked=false; toggleBody(); } });
toggleBody();
})();


// Calcular --safeTop dinámicamente para evitar cortes del menú
(function(){
const root = document.documentElement;
const contact = document.querySelector('.contact-bar');
const nav = document.querySelector('.nav');
function setSafeTop(){
const top = (contact?.offsetHeight || 0) + (nav?.offsetHeight || 0);
root.style.setProperty('--safeTop', top + 'px');
}
setSafeTop();
window.addEventListener('resize', setSafeTop);
window.addEventListener('orientationchange', setSafeTop);
// Ajuste tras cargar fuentes/íconos
window.addEventListener('load', setSafeTop);
})();
</script>
</body>
</html>
